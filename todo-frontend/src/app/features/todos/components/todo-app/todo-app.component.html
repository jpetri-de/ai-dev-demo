<section class="todoapp">
  <!-- Error display -->
  <div *ngIf="error$ | async as error" class="error-banner" style="background: #f44336; color: white; padding: 10px; margin-bottom: 20px;">
    {{ error }}
    <button (click)="clearError()" style="float: right; background: none; border: none; color: white; cursor: pointer;">Ã—</button>
  </div>

  <!-- Header with input -->
  <header class="header">
    <h1>todos</h1>
    <input 
      class="new-todo" 
      placeholder="What needs to be done?" 
      autofocus 
      #newTodoInput
      [disabled]="isCreating"
      (keyup.enter)="onCreateTodo(newTodoInput.value)"
      maxlength="500"
      [attr.aria-label]="'Create new todo. Press Enter to add.'">
  </header>

  <!-- Main section with toggle all and todo list -->
  <section class="main" *ngIf="(stats$ | async)?.total! > 0">
    <input 
      id="toggle-all" 
      class="toggle-all" 
      type="checkbox"
      [checked]="(stats$ | async)?.active === 0 && (stats$ | async)?.total! > 0"
      (change)="onToggleAll()"
      [attr.aria-label]="'Toggle all todos ' + ((stats$ | async)?.active === 0 ? 'incomplete' : 'complete')">
    <label for="toggle-all">Mark all as complete</label>
    
    <app-todo-list 
      [todos]="todos$ | async" 
      [filter]="currentFilter"
      (toggleTodo)="onToggleTodo($event)"
      (deleteTodo)="onDeleteTodo($event)"
      (updateTodo)="onUpdateTodo($event)">
    </app-todo-list>
  </section>

  <!-- Footer with counter, filters, and clear completed -->
  <footer class="footer" *ngIf="(stats$ | async)?.total! > 0">
    <app-todo-counter></app-todo-counter>
    
    <app-todo-filter 
      [currentFilter]="currentFilter" 
      (filterChange)="onFilterChange($event)">
    </app-todo-filter>
    
    <app-clear-completed 
      (clearCompleted)="onClearCompleted()">
    </app-clear-completed>
  </footer>
</section>